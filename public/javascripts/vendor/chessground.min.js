!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Chessground=e()}}((function(){return function e(t,o,n){function r(s,a){if(!o[s]){if(!t[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(i)return i(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var d=o[s]={exports:{}};t[s][0].call(d.exports,(function(e){return r(t[s][1][e]||e)}),d,d.exports,e,t,o,n)}return o[s].exports}for(var i="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.render=o.anim=void 0;const n=e("./util");function r(e,t){const o=e(t);return t.dom.redraw(),o}function i(e,t){return{key:e,pos:n.key2pos(e),piece:t}}function s(e,t){return t.sort(((t,o)=>n.distanceSq(e.pos,t.pos)-n.distanceSq(e.pos,o.pos)))[0]}function a(e,t){const o=e.animation.current;if(void 0===o)return void(e.dom.destroyed||e.dom.redrawNow());const n=1-(t-o.start)*o.frequency;if(n<=0)e.animation.current=void 0,e.dom.redrawNow();else{const t=(r=n)<.5?4*r*r*r:(r-1)*(2*r-2)*(2*r-2)+1;for(const e of o.plan.anims.values())e[2]=e[0]*t,e[3]=e[1]*t;e.dom.redrawNow(!0),requestAnimationFrame(((t=performance.now())=>a(e,t)))}var r}o.anim=function(e,t){return t.animation.enabled?function(e,t){const o=new Map(t.pieces),r=e(t),c=function(e,t){const o=new Map,r=[],a=new Map,c=[],l=[],d=new Map;let p,u,h;for(const[n,s]of e)d.set(n,i(n,s));for(const s of n.allKeys(t.dimensions))p=t.pieces.get(s),u=d.get(s),p?u?n.samePiece(p,u.piece)||(c.push(u),l.push(i(s,p))):l.push(i(s,p)):u&&c.push(u);for(const i of l)u=s(i,c.filter((e=>n.samePiece(i.piece,e.piece)))),u&&(h=[u.pos[0]-i.pos[0],u.pos[1]-i.pos[1]],o.set(i.key,h.concat(h)),r.push(u.key));for(const n of c)r.includes(n.key)||a.set(n.key,n.piece);return{anims:o,fadings:a}}(o,t);if(c.anims.size||c.fadings.size){const e=t.animation.current&&t.animation.current.start;t.animation.current={start:performance.now(),frequency:1/t.animation.duration,plan:c},e||a(t,performance.now())}else t.dom.redraw();return r}(e,t):r(e,t)},o.render=r},{"./util":20}],2:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.start=void 0;const n=e("./board"),r=e("./fen"),i=e("./config"),s=e("./anim"),a=e("./drag"),c=e("./explosion");o.start=function(e,t){return{set(o){var r;o.orientation&&o.orientation!==e.orientation&&(r=o.orientation,n.setOrientation(e,r),t()),(o.fen?s.anim:s.render)((e=>(0,i.configure)(e,o)),e)},state:e,getFen:()=>(0,r.write)(e.pieces,e.dimensions),toggleOrientation:function(){n.toggleOrientation(e),t()},setPieces(t){(0,s.anim)((e=>n.setPieces(e,t)),e)},selectSquare(t,o){t?(0,s.anim)((e=>n.selectSquare(e,t,o)),e):e.selected&&(n.unselect(e),e.dom.redraw())},move(t,o){(0,s.anim)((e=>n.baseMove(e,t,o)),e)},newPiece(t,o){(0,s.anim)((e=>n.baseNewPiece(e,t,o)),e)},playPremove(){if(e.premovable.current){if((0,s.anim)(n.playPremove,e))return!0;e.dom.redraw()}return!1},playPredrop(t){if(e.predroppable.current){const o=n.playPredrop(e,t);return e.dom.redraw(),o}return!1},cancelPremove(){(0,s.render)(n.unsetPremove,e)},cancelPredrop(){(0,s.render)(n.unsetPredrop,e)},cancelMove(){(0,s.render)((e=>{n.cancelMove(e),(0,a.cancel)(e)}),e)},stop(){(0,s.render)((e=>{n.stop(e),(0,a.cancel)(e)}),e)},explode(t){(0,c.default)(e,t)},setAutoShapes(t){(0,s.render)((e=>e.drawable.autoShapes=t),e)},setShapes(t){(0,s.render)((e=>e.drawable.shapes=t),e)},getKeyAtDomPos:t=>n.getKeyAtDomPos(t,e.orientation,e.dom.bounds(),e.dimensions),redrawAll:t,dragNewPiece(t,o,n){(0,a.dragNewPiece)(e,t,o,n)},destroy(){n.stop(e),e.dom.unbind&&e.dom.unbind(),e.dom.destroyed=!0}}}},{"./anim":1,"./board":3,"./config":5,"./drag":6,"./explosion":10,"./fen":11}],3:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.getSnappedKeyAtDomPos=o.whitePov=o.getKeyAtDomPos=o.stop=o.cancelMove=o.playPredrop=o.playPremove=o.isDraggable=o.isPredroppable=o.canMove=o.unselect=o.setSelected=o.selectSquare=o.dropNewPiece=o.userMove=o.baseNewPiece=o.baseMove=o.unsetPredrop=o.unsetPremove=o.setPieces=o.reset=o.toggleOrientation=o.setOrientation=void 0;const n=e("./util"),r=e("./premove"),i=e("./predrop"),s=e("./transformations");function a(e,t){e.orientation=t,e.animation.current=e.draggable.current=e.selected=void 0}function c(e){e.premovable.current&&(e.premovable.current=void 0,(0,n.callUserFunction)(e.premovable.events.unset))}function l(e){const t=e.predroppable;t.current&&(t.current=void 0,(0,n.callUserFunction)(t.events.unset))}function d(e,t,o){const r=e.pieces.get(t),i=e.pieces.get(o);if(t===o||!r)return!1;const s=i&&i.color!==r.color?i:void 0;return o===e.selected&&b(e),(0,n.callUserFunction)(e.events.move,t,o,s),function(e,t,o){if(!e.autoCastle)return!1;const r=e.pieces.get(t);if(!r||"k-piece"!==r.role)return!1;const i=(0,n.key2pos)(t),s=(0,n.key2pos)(o);if(1!==i[1]&&8!==i[1]||i[1]!==s[1])return!1;5!==i[0]||e.pieces.has(o)||(7===s[0]?o=(0,n.pos2key)([8,s[1]]):3===s[0]&&(o=(0,n.pos2key)([1,s[1]])));const a=e.pieces.get(o);return!(!a||a.color!==r.color||"r-piece"!==a.role||(e.pieces.delete(t),e.pieces.delete(o),i[0]<s[0]?(e.pieces.set((0,n.pos2key)([7,s[1]]),r),e.pieces.set((0,n.pos2key)([6,s[1]]),a)):(e.pieces.set((0,n.pos2key)([3,s[1]]),r),e.pieces.set((0,n.pos2key)([4,s[1]]),a)),0))}(e,t,o)||(e.pieces.set(o,r),e.pieces.delete(t)),e.lastMove=[t,o],e.check=void 0,(0,n.callUserFunction)(e.events.change),s||!0}function p(e,t,o,r){if(e.pieces.has(o)){if(!r)return!1;e.pieces.delete(o)}return(0,n.callUserFunction)(e.events.dropNewPiece,t,o),e.pieces.set(o,t),e.lastMove=[o],e.check=void 0,(0,n.callUserFunction)(e.events.change),e.movable.dests=void 0,e.dropmode.dropDests=void 0,e.turnColor=(0,n.opposite)(e.turnColor),!0}function u(e,t,o){const r=d(e,t,o);return r&&(e.movable.dests=void 0,e.dropmode.dropDests=void 0,e.turnColor=(0,n.opposite)(e.turnColor),e.animation.current=void 0),r}function h(e,t,o){if(m(e,t,o)){const r=u(e,t,o);if(r){const i=e.hold.stop();b(e);const s={premove:!1,ctrlKey:e.stats.ctrlKey,holdTime:i};return!0!==r&&(s.captured=r),(0,n.callUserFunction)(e.movable.events.after,t,o,s),!0}}else if(function(e,t,o){return t!==o&&v(e,t)&&(0,n.containsX)((0,r.premove)(e.pieces,t,e.premovable.castle,e.dimensions,e.variant,e.chess960),o)}(e,t,o))return function(e,t,o,r){l(e),e.premovable.current=[t,o],(0,n.callUserFunction)(e.premovable.events.set,t,o,r)}(e,t,o,{ctrlKey:e.stats.ctrlKey}),b(e),!0;return b(e),!1}function f(e,t){e.selected=t,v(e,t)?e.premovable.dests=(0,r.premove)(e.pieces,t,e.premovable.castle,e.dimensions,e.variant,e.chess960):(e.premovable.dests=void 0,e.predroppable.dropDests=void 0)}function b(e){e.selected=void 0,e.premovable.dests=void 0,e.predroppable.dropDests=void 0,e.hold.cancel()}function g(e,t){const o=e.pieces.get(t);return!!o&&("both"===e.movable.color||e.movable.color===o.color&&e.turnColor===o.color)}function m(e,t,o){var n,r;return t!==o&&g(e,t)&&(e.movable.free||!!(null===(r=null===(n=e.movable.dests)||void 0===n?void 0:n.get(t))||void 0===r?void 0:r.includes(o)))}function v(e,t){const o=e.pieces.get(t);return!!o&&e.premovable.enabled&&e.movable.color===o.color&&e.turnColor!==o.color}function k(e){c(e),l(e),b(e)}o.setOrientation=a,o.toggleOrientation=function(e){a(e,(0,n.oppositeOrientation)(e.orientation))},o.reset=function(e){e.lastMove=void 0,b(e),c(e),l(e)},o.setPieces=function(e,t){for(const[o,n]of t)n?e.pieces.set(o,n):e.pieces.delete(o)},o.unsetPremove=c,o.unsetPredrop=l,o.baseMove=d,o.baseNewPiece=p,o.userMove=h,o.dropNewPiece=function(e,t,o,r){const s=e.pieces.get(t);var a,d;s&&(function(e,t,o){const n=e.pieces.get(t);return!(!n||t!==o&&e.pieces.has(o)||"both"!==e.movable.color&&(e.movable.color!==n.color||e.turnColor!==n.color))}(e,t,o)||r)?(e.pieces.delete(t),p(e,s,o,r),(0,n.callUserFunction)(e.movable.events.afterNewPiece,s.role,o,{premove:!1,predrop:!1})):s&&function(e,t,o){const r=e.pieces.get(t),s=e.pieces.get(o);if(!r)return!1;const a=(0,n.containsX)((0,i.default)(e.pieces,r,e.dimensions,e.variant),o);return(!s||s.color!==e.movable.color)&&e.predroppable.enabled&&a&&e.movable.color===r.color&&e.turnColor!==r.color}(e,t,o)?function(e,t,o){c(e),e.predroppable.current={role:t,key:o},(0,n.callUserFunction)(e.predroppable.events.set,t,o)}(e,s.role,o):(c(e),l(e),(a=e).dropmode.active=!1,(0,n.callUserFunction)(null===(d=a.dropmode.events)||void 0===d?void 0:d.cancel)),e.pieces.delete(t),b(e)},o.selectSquare=function(e,t,o){if((0,n.callUserFunction)(e.events.select,t),e.selected){if(e.selected===t&&!e.draggable.enabled)return b(e),void e.hold.cancel();if((e.selectable.enabled||o)&&e.selected!==t&&h(e,e.selected,t))return void(e.stats.dragged=!1)}(g(e,t)||v(e,t))&&(f(e,t),e.hold.start())},o.setSelected=f,o.unselect=b,o.canMove=m,o.isPredroppable=function(e){var t,o;const n=e.dropmode.active?e.dropmode.piece:null===(t=e.draggable.current)||void 0===t?void 0:t.piece;return!!n&&(e.dropmode.active||"a0"===(null===(o=e.draggable.current)||void 0===o?void 0:o.orig))&&e.predroppable.enabled&&e.movable.color===n.color&&e.turnColor!==n.color},o.isDraggable=function(e,t){const o=e.pieces.get(t);return!!o&&e.draggable.enabled&&("both"===e.movable.color||e.movable.color===o.color&&(e.turnColor===o.color||e.premovable.enabled))},o.playPremove=function(e){const t=e.premovable.current;if(!t)return!1;const o=t[0],r=t[1];let i=!1;if(m(e,o,r)){const t=u(e,o,r);if(t){const s={premove:!0};!0!==t&&(s.captured=t),(0,n.callUserFunction)(e.movable.events.after,o,r,s),i=!0}}return c(e),i},o.playPredrop=function(e,t){const o=e.predroppable.current;let r=!1;if(!o)return!1;if(t(o)){p(e,{role:o.role,color:e.movable.color},o.key)&&((0,n.callUserFunction)(e.movable.events.afterNewPiece,o.role,o.key,{premove:!1,predrop:!0}),r=!0)}return l(e),r},o.cancelMove=k,o.stop=function(e){e.movable.color=e.movable.dests=e.dropmode.dropDests=e.animation.current=void 0,k(e)},o.getKeyAtDomPos=function(e,t,o,r){return e=[Math.ceil(r.width*((e[0]-o.left)/o.width)),Math.ceil(r.height-r.height*((e[1]-o.top)/o.height))],(e=s.mapToWhite[t](e,r))[0]>0&&e[0]<r.width+1&&e[1]>0&&e[1]<r.height+1?(0,n.pos2key)(e):void 0},o.whitePov=function(e){return"white"===e.myColor},o.getSnappedKeyAtDomPos=function(e,t,o,i,s){const a=(0,n.key2pos)(e),c=(0,n.allPos)(s).filter((e=>(0,r.queen)(a[0],a[1],e[0],e[1])||(0,r.knight)(a[0],a[1],e[0],e[1]))),l=c.map((e=>(0,n.computeSquareCenter)((0,n.pos2key)(e),o,i,s))).map((e=>(0,n.distanceSq)(t,e))),[,d]=l.reduce(((e,t,o)=>e[0]<t?e:[t,o]),[l[0],0]);return(0,n.pos2key)(c[d])}},{"./predrop":13,"./premove":14,"./transformations":18,"./util":20}],4:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.Chessground=void 0;const n=e("./api"),r=e("./config"),i=e("./state"),s=e("./wrap"),a=e("./events"),c=e("./render"),l=e("./svg"),d=e("./util");function p(e){let t=!1;return()=>{t||(t=!0,requestAnimationFrame((()=>{e(),t=!1})))}}o.Chessground=function(e,t){const o=(0,i.defaults)();function u(){const t="dom"in o?o.dom.unbind:void 0,n=o.viewOnly&&!o.drawable.visible,r=(0,s.renderWrap)(e,o,n),i=d.memo((()=>r.board.getBoundingClientRect())),u=e=>{(0,c.render)(f),!e&&r.svg&&l.renderSvg(f,r.svg,r.customSvg)},h=()=>{i.clear(),(0,c.updateBounds)(f),r.svg&&l.renderSvg(f,r.svg,r.customSvg)},f=o;return f.dom={elements:r,bounds:i,redraw:p(u),redrawNow:u,unbind:t,relative:n},f.drawable.prevSvgHash="",u(!1),a.bindBoard(f,h),t||(f.dom.unbind=a.bindDocument(f,h)),f.events.insert&&f.events.insert(r),f}return(0,r.configure)(o,t||{}),(0,n.start)(u(),u)}},{"./api":2,"./config":5,"./events":9,"./render":15,"./state":16,"./svg":17,"./util":20,"./wrap":21}],5:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.configure=void 0;const n=e("./board"),r=e("./fen");function i(e,t){for(const o in t)s(e[o])&&s(t[o])?i(e[o],t[o]):e[o]=t[o]}function s(e){return"object"==typeof e}o.configure=function(e,t){var o,s;if(t.movable&&t.movable.dests&&(e.movable.dests=void 0),(null===(o=t.dropmode)||void 0===o?void 0:o.dropDests)&&(e.dropmode.dropDests=void 0),(null===(s=t.drawable)||void 0===s?void 0:s.autoShapes)&&(e.drawable.autoShapes=[]),i(e,t),t.dimensions&&(e.dimensions=t.dimensions),t.fen){const o=(0,r.read)(t.fen,e.dimensions);void 0!==e.pieces.get("a0")&&o.set("a0",e.pieces.get("a0")),e.pieces=o,e.drawable.shapes=[]}if("check"in t&&function(e,t){e.check=void 0,!0===t&&(t=e.turnColor);if(t)for(const[o,n]of e.pieces)"k-piece"===n.role&&n.color===t&&(e.check=o)}(e,t.check||!1),"lastMove"in t&&!t.lastMove?e.lastMove=void 0:t.lastMove&&(e.lastMove=t.lastMove),e.selected&&(0,n.setSelected)(e,e.selected),(!e.animation.duration||e.animation.duration<100)&&(e.animation.enabled=!1),!e.movable.rookCastle&&e.movable.dests){const t="white"===e.movable.color?1:8,o="e"+t,n=e.movable.dests.get(o),r=e.pieces.get(o);if(!n||!r||"k-piece"!==r.role)return;e.movable.dests.set(o,n.filter((e=>!(e==="a"+t&&n.includes("c"+t)||e==="h"+t&&n.includes("g"+t)))))}}},{"./board":3,"./fen":11}],6:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.cancel=o.end=o.move=o.dragNewPiece=o.start=void 0;const n=e("./board"),r=e("./util"),i=e("./draw"),s=e("./anim"),a=e("./predrop"),c=e("./transformations");function l(e){requestAnimationFrame((()=>{var t;const o=e.draggable.current;if(!o)return;(null===(t=e.animation.current)||void 0===t?void 0:t.plan.anims.has(o.orig))&&(e.animation.current=void 0);const n=e.pieces.get(o.orig);if(n&&r.samePiece(n,o.piece)){if(!o.started&&r.distanceSq(o.epos,o.rel)>=Math.pow(e.draggable.distance,2)&&(o.started=!0),o.started){if("function"==typeof o.element){const e=o.element();if(!e)return;e.cgDragging=!0,e.classList.add("dragging"),o.element=e}o.pos=[o.epos[0]-o.rel[0],o.epos[1]-o.rel[1]];const t=r.posToTranslateAbs(e.dom.bounds(),e.dimensions)(o.origPos,e.orientation);t[0]+=o.pos[0]+o.dec[0],t[1]+=o.pos[1]+o.dec[1],r.translateAbs(o.element,t)}}else d(e);l(e)}))}function d(e){const t=e.draggable.current;t&&(t.newPiece&&e.pieces.delete(t.orig),e.draggable.current=void 0,n.unselect(e),p(e),e.dom.redraw())}function p(e){const t=e.dom.elements;t.ghost&&r.setVisible(t.ghost,!1)}function u(e,t,o,n){const i=c.mapToWhiteInverse[n](r.key2pos(e),o);return{left:t.left+t.width*(i[0]-1)/o.width,top:t.top+t.height*(o.height-i[1])/o.height,width:t.width/o.width,height:t.height/o.height}}function h(e,t){let o=e.dom.elements.board.firstChild;for(;o;){if(o.cgKey===t&&"PIECE"===o.tagName)return o;o=o.nextSibling}}o.start=function(e,t){if(!t.isTrusted||void 0!==t.button&&0!==t.button)return;if(t.touches&&t.touches.length>1)return;const o=e.dom.bounds(),a=r.eventPosition(t),c=n.getKeyAtDomPos(a,e.orientation,o,e.dimensions);if(!c)return;const d=e.pieces.get(c),p=e.selected;p||!e.drawable.enabled||!e.drawable.eraseOnClick&&d&&d.color===e.turnColor||(0,i.clear)(e),!1===t.cancelable||t.touches&&e.movable.color&&!d&&!p&&!function(e,t){const o=e.orientation,n=e.dom.bounds(),i=Math.pow(n.width/8,2);for(const s in e.pieces){const a=u(s,n,e.dimensions,o),c=[a.left+a.width/2,a.top+a.height/2];if(r.distanceSq(c,t)<=i)return!0}return!1}(e,a)||t.preventDefault();const f=!!e.premovable.current,b=!!e.predroppable.current;e.stats.ctrlKey=t.ctrlKey,e.selected&&n.canMove(e,e.selected,c)?(0,s.anim)((e=>n.selectSquare(e,c)),e):n.selectSquare(e,c);const g=e.selected===c,m=h(e,c);if(d&&m&&g&&n.isDraggable(e,c)){const n=u(c,o,e.dimensions,e.orientation);e.draggable.current={orig:c,origPos:r.key2pos(c),piece:d,rel:a,epos:a,pos:[0,0],dec:e.draggable.centerPiece?[a[0]-(n.left+n.width/2),a[1]-(n.top+n.height/2)]:[0,0],started:e.draggable.autoDistance&&e.stats.dragged,element:m,previouslySelected:p,originTarget:t.target},m.cgDragging=!0,m.classList.add("dragging");const i=e.dom.elements.ghost;if(i){const t=d.promoted?"promoted ":"",n=d.color===e.myColor?"ally":"enemy";i.className=`ghost ${d.color} ${t}${d.role} ${n}`,r.translateAbs(i,r.posToTranslateAbs(o,e.dimensions)(r.key2pos(c),e.orientation)),r.setVisible(i,!0)}l(e)}else f&&n.unsetPremove(e),b&&n.unsetPredrop(e);e.dom.redraw()},o.dragNewPiece=function(e,t,o,i){const s="a0";e.pieces.set(s,t),e.dom.redraw();const c=r.eventPosition(o),d=n.whitePov(e),p=e.dom.bounds(),f=u(s,p,e.dimensions,e.orientation),b=[(d?0:e.dimensions.width-1)*f.width+p.left,(d?e.dimensions.height:-1)*f.height+p.top];e.draggable.current={orig:s,origPos:r.key2pos("a0"),piece:t,rel:b,epos:c,pos:[c[0]-b[0],c[1]-b[1]],dec:[-f.width/2,-f.height/2],started:!0,element:()=>h(e,s),originTarget:o.target,newPiece:!0,force:!!i},t&&n.isPredroppable(e)&&(e.predroppable.dropDests=(0,a.default)(e.pieces,t,e.dimensions,e.variant)),l(e)},o.move=function(e,t){e.draggable.current&&(!t.touches||t.touches.length<2)&&(e.draggable.current.epos=r.eventPosition(t))},o.end=function(e,t){const o=e.draggable.current;if(!o)return;if("touchend"===t.type&&!1!==t.cancelable&&t.preventDefault(),"touchend"===t.type&&o&&o.originTarget!==t.target&&!o.newPiece)return void(e.draggable.current=void 0);n.unsetPremove(e),n.unsetPredrop(e);const i=r.eventPosition(t)||o.pos,s=n.getKeyAtDomPos(i,e.orientation,e.dom.bounds(),e.dimensions);s&&o.started&&o.orig!==s?o.newPiece?n.dropNewPiece(e,o.orig,s,o.force):(e.stats.ctrlKey=t.ctrlKey,n.userMove(e,o.orig,s)&&(e.stats.dragged=!0)):o.newPiece?e.pieces.delete(o.orig):e.draggable.deleteOnDropOff&&!s&&(e.pieces.delete(o.orig),r.callUserFunction(e.events.change)),(!o||o.orig!==o.previouslySelected||o.orig!==s&&s)&&e.selectable.enabled||n.unselect(e),p(e),e.draggable.current=void 0,e.dom.redraw()},o.cancel=d},{"./anim":1,"./board":3,"./draw":7,"./predrop":13,"./transformations":18,"./util":20}],7:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.clear=o.cancel=o.end=o.move=o.processDraw=o.start=void 0;const n=e("./board"),r=e("./util"),i=["green","red","blue","yellow"];function s(e){requestAnimationFrame((()=>{const t=e.drawable.current;if(t){const o=(0,n.getKeyAtDomPos)(t.pos,e.orientation,e.dom.bounds(),e.dimensions);o||(t.snapToValidMove=!1);const r=t.snapToValidMove?(0,n.getSnappedKeyAtDomPos)(t.orig,t.pos,e.orientation,e.dom.bounds(),e.dimensions):o;r!==t.mouseSq&&(t.mouseSq=r,t.dest=r!==t.orig?r:void 0,e.dom.redrawNow()),s(e)}}))}function a(e){e.drawable.current&&(e.drawable.current=void 0,e.dom.redraw())}function c(e){var t;const o=(e.shiftKey||e.ctrlKey)&&(0,r.isRightButton)(e),n=e.altKey||e.metaKey||(null===(t=e.getModifierState)||void 0===t?void 0:t.call(e,"AltGraph"));return i[(o?1:0)+(n?2:0)]}function l(e){e.onChange&&e.onChange(e.shapes)}o.start=function(e,t){if(t.touches&&t.touches.length>1)return;t.stopPropagation(),t.preventDefault(),t.ctrlKey?(0,n.unselect)(e):(0,n.cancelMove)(e);const o=(0,r.eventPosition)(t),i=(0,n.getKeyAtDomPos)(o,e.orientation,e.dom.bounds(),e.dimensions);i&&(e.drawable.current={orig:i,pos:o,brush:c(t),snapToValidMove:e.drawable.defaultSnapToValidMove},s(e))},o.processDraw=s,o.move=function(e,t){e.drawable.current&&(e.drawable.current.pos=(0,r.eventPosition)(t))},o.end=function(e){const t=e.drawable.current;t&&(t.mouseSq&&function(e,t){const o=e=>e.orig===t.orig&&e.dest===t.dest,n=e.shapes.filter(o)[0];n&&(e.shapes=e.shapes.filter((e=>!o(e))));n&&n.brush===t.brush||e.shapes.push(t);l(e)}(e.drawable,t),a(e))},o.cancel=a,o.clear=function(e){e.drawable.shapes.length&&(e.drawable.shapes=[],e.dom.redraw(),l(e.drawable))}},{"./board":3,"./util":20}],8:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.drop=o.cancelDropMode=o.setDropMode=void 0;const n=e("./board"),r=e("./util"),i=e("./drag"),s=e("./predrop");o.setDropMode=function(e,t){e.dropmode.active=!0,e.dropmode.piece=t,(0,i.cancel)(e),n.unselect(e),t&&n.isPredroppable(e)&&(e.predroppable.dropDests=(0,s.default)(e.pieces,t,e.dimensions,e.variant))},o.cancelDropMode=function(e){var t;e.dropmode.active=!1,r.callUserFunction(null===(t=e.dropmode.events)||void 0===t?void 0:t.cancel)},o.drop=function(e,t){if(!e.dropmode.active)return;n.unsetPremove(e),n.unsetPredrop(e);const o=e.dropmode.piece;if(o){e.pieces.set("a0",o);const i=r.eventPosition(t),s=i&&n.getKeyAtDomPos(i,e.orientation,e.dom.bounds(),e.dimensions);s&&n.dropNewPiece(e,"a0",s)}e.dom.redraw()}},{"./board":3,"./drag":6,"./predrop":13,"./util":20}],9:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.bindDocument=o.bindBoard=void 0;const n=e("./drag"),r=e("./draw"),i=e("./drop"),s=e("./util"),a=e("./board");function c(e,t,o,n){return e.addEventListener(t,o,n),()=>e.removeEventListener(t,o,n)}function l(e,t,o){return n=>{e.drawable.current?e.drawable.enabled&&o(e,n):e.viewOnly||t(e,n)}}function d(e,t){const o=(0,s.eventPosition)(t),n=o&&(0,a.getKeyAtDomPos)(o,e.orientation,e.dom.bounds(),e.dimensions);if(n&&e.pieces.get(n))return e.pieces.get(n)}o.bindBoard=function(e,t){const o=e.dom.elements.board;if(!e.dom.relative&&e.resizable&&"ResizeObserver"in window){new window.ResizeObserver(t).observe(o)}if(e.viewOnly)return;const a=function(e){return t=>{var o;e.draggable.current?n.cancel(e):e.drawable.current?r.cancel(e):t.shiftKey||(0,s.isRightButton)(t)?e.drawable.enabled&&r.start(e,t):e.viewOnly||(e.dropmode.active&&void 0===d(e,t)||e.dropmode.active&&e.movable.color!==e.turnColor&&(null===(o=d(e,t))||void 0===o?void 0:o.color)===e.turnColor?(0,i.drop)(e,t):((0,i.cancelDropMode)(e),n.start(e,t)))}}(e);o.addEventListener("touchstart",a,{passive:!1}),o.addEventListener("mousedown",a,{passive:!1}),(e.disableContextMenu||e.drawable.enabled)&&o.addEventListener("contextmenu",(e=>e.preventDefault()))},o.bindDocument=function(e,t){const o=[];if(e.dom.relative||!e.resizable||"ResizeObserver"in window||o.push(c(document.body,"chessground.resize",t)),!e.viewOnly){const t=l(e,n.move,r.move),i=l(e,n.end,r.end);for(const e of["touchmove","mousemove"])o.push(c(document,e,t));for(const e of["touchend","mouseup"])o.push(c(document,e,i));const s=()=>e.dom.bounds.clear();o.push(c(document,"scroll",s,{capture:!0,passive:!0})),o.push(c(window,"resize",s,{passive:!0}))}return()=>o.forEach((e=>e()))}},{"./board":3,"./drag":6,"./draw":7,"./drop":8,"./util":20}],10:[function(e,t,o){"use strict";function n(e,t){e.exploding&&(t?e.exploding.stage=t:e.exploding=void 0,e.dom.redraw())}Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(e,t){e.exploding={stage:1,keys:t},e.dom.redraw(),setTimeout((()=>{n(e,2),setTimeout((()=>n(e,void 0)),120)}),120)}},{}],11:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.write=o.read=o.initial=void 0;const n=e("./util");function r(e){return e.replace("+","p")+"-piece"}function i(e){const t=e.slice(0,e.indexOf("-"));return t.length>1?t.replace("p","+"):t}o.initial="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR",o.read=function(e,t){"start"===e&&(e=o.initial),-1!==e.indexOf("[")&&(e=e.slice(0,e.indexOf("[")));const i=new Map;let s=t.height,a=0,c=!1,l=0;for(const o of e)switch(o){case" ":return i;case"/":if(--s,0===s)return i;a=0,l=0;break;case"+":c=!0;break;case"~":{const e=i.get((0,n.pos2key)([a,s]));e&&(e.promoted=!0);break}default:{const e=o.charCodeAt(0);if(48<=e&&e<58)l=10*l+e-48;else{a+=1+l,l=0;const e=o.toLowerCase(),t={role:r(e),color:o===e?"black":"white"};c&&(t.role="p"+t.role,t.promoted=!0,c=!1),i.set((0,n.pos2key)([a,s]),t)}}}return i},o.write=function(e,t){return n.invNRanks.slice(-t.height).map((o=>n.NRanks.slice(0,t.width).map((t=>{const r=e.get((0,n.pos2key)([t,o]));if(r){const e=i(r.role)+(r.promoted&&"+"!==i(r.role).charAt(0)?"~":"");return"white"===r.color?e.toUpperCase():e}return"1"})).join(""))).join("/").replace(/1{2,}/g,(e=>e.length.toString()))}},{"./util":20}],12:[function(e,t,o){t.exports=e("./chessground").Chessground},{"./chessground":4}],13:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});const n=e("./util"),r=(e,t)=>!0;function i(e,t,o,n){const r=n.height;return e<1&&(e+=r),t<1&&(t+=r),(n,i)=>("black"===o&&(i=r-i+1),e<=i&&i<=t)}o.default=function(e,t,o,s){const a=t.color,c=t.role;let l=r;switch(s){case"crazyhouse":case"shouse":case"capahouse":case"gothhouse":if("p-piece"===c)l=i(2,-1,a,o);break;case"placement":l=i(1,1,a,o);break;case"sittuyin":if("r-piece"===c)l=i(1,1,a,o);else l=(e,t)=>{const n=o.width,r=o.height;return"black"===a&&(e=n-e+1,t=r-t+1),t<3||3===t&&e>4};break;case"shogi":case"minishogi":case"gorogoro":switch(c){case"p-piece":case"l-piece":l=i(1,-1,a,o);break;case"n-piece":l=i(1,-2,a,o)}break;case"kyotoshogi":case"dobutsu":l=r;break;case"torishogi":if("s-piece"===c)l=i(1,-1,a,o);break;case"grandhouse":if("p-piece"===c)l=i(2,7,a,o);break;case"shogun":l=i(1,5,a,o);break;case"synochess":l=(e,t)=>5===t;break;case"shinobi":l=(e,t)=>t<=4;break;default:console.warn("Unknown drop variant",s)}return n.allKeys(o).map(n.key2pos).filter((t=>{var o;return(null===(o=e.get(n.pos2key(t)))||void 0===o?void 0:o.color)!==a&&l(t[0],t[1])})).map(n.pos2key)}},{"./util":20}],14:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.premove=o.loachecker=o.queen=o.knight=void 0;const n=e("./util");function r(e,t){return Math.abs(e-t)}function i(e){return(t,o,n,i)=>r(t,n)<2&&("white"===e?i===o+1||o<=2&&i===o+2&&t===n:i===o-1||o>=7&&i===o-2&&t===n)}o.knight=(e,t,o,n)=>{const i=r(e,o),s=r(t,n);return 1===i&&2===s||2===i&&1===s};const s=(e,t,o,n)=>r(e,o)===r(t,n),a=(e,t,o,n)=>e===o||t===n;o.queen=(e,t,o,n)=>s(e,t,o,n)||a(e,t,o,n);function c(e,t,o){return(i,s,a,c)=>r(i,a)<2&&r(s,c)<2||o&&s===c&&s===("white"===e?1:8)&&(5===i&&(n.containsX(t,1)&&3===a||n.containsX(t,8)&&7===a)||n.containsX(t,a))}function l(e,t){const o="white"===t?"1":"8",r=[];for(const[i,s]of e)i[1]===o&&s&&s.color===t&&"r-piece"===s.role&&r.push(n.key2pos(i)[0]);return r}o.loachecker=(e,t,o,n)=>s(e,t,o,n)||a(e,t,o,n);const d=(e,t,o,n)=>r(e,o)<2&&r(t,n)<2;function p(e,t,o){return(r,i,s,a)=>d(r,i,s,a)||o&&i===a&&i===("white"===e?1:8)&&n.containsX(t,s)}const u=(e,t,o,n)=>{const i=r(e,o),s=r(t,n);return 1===i&&0===s||0===i&&1===s},h=(e,t,o,n)=>r(e,o)===r(t,n)&&1===r(e,o),f=(e,t,n,r)=>s(e,t,n,r)||(0,o.knight)(e,t,n,r),b=(e,t,n,r)=>a(e,t,n,r)||(0,o.knight)(e,t,n,r),g=(e,t,n,r)=>s(e,t,n,r)||a(e,t,n,r)||(0,o.knight)(e,t,n,r),m=(e,t,n,r)=>d(e,t,n,r)||(0,o.knight)(e,t,n,r);function v(e){return(t,o,n,i)=>r(t,n)<2&&("white"===e?i===o+1||o<=3&&i===o+2&&t===n:i===o-1||o>=8&&i===o-2&&t===n)}function k(e){return(t,o,n,r)=>n===t&&("white"===e?r>o:r<o)}function w(e){return(t,o,n,r)=>h(t,o,n,r)||t===n&&("white"===e?r===o+1:r===o-1)}function y(e){return(t,o,n,i)=>u(t,o,n,i)||r(t,n)<2&&("white"===e?i===o+1:i===o-1)}function P(e){return(t,o,n,r)=>n===t&&("white"===e?r===o+1:r===o-1)}function C(e){return(t,o,n,r)=>(n===t-1||n===t+1)&&("white"===e?r===o+2:r===o-2)}const M=(e,t,o,n)=>a(e,t,o,n)||h(e,t,o,n),S=(e,t,o,n)=>s(e,t,o,n)||u(e,t,o,n);function q(e,t){const o=Math.floor((e.width+1)/2),n="white"===t?1:e.height-2;return[[o-1,n+2],[o,n+2],[o+1,n+2],[o-1,n+1],[o,n+1],[o+1,n+1],[o-1,n],[o,n],[o+1,n]]}function D(e){return(t,o,n,i)=>n===t&&("white"===e?i===o+1:i===o-1)||i===o&&r(t,n)<2}function O(e){return(t,o,n,i)=>((e,t,o,n)=>{const i=r(e,o);return i===r(t,n)&&2===i})(t,o,n,i)&&("white"===e?i<6:i>5)}function x(e,t){const o=q(t,e);return(e,t,n,r)=>u(e,t,n,r)&&o.some((e=>e[0]===n&&e[1]===r))}const A=(e,t,o,n)=>r(e,o)===r(t,n)&&r(e,o)<3,T=(e,t,o,n)=>{const i=r(e,o),s=r(t,n);return 2===i&&3===s||3===i&&2===s};const K=(e,t,o,n)=>{const i=r(e,o),s=r(t,n);return!(1!==i&&2!==i||1!==s&&2!==s)},_=(e,t,o,n)=>{const i=r(e,o),s=r(t,n);return 0===i&&(2===s||3===s)||0===s&&(2===i||3===i)||i===s&&(2===i||3===i)},N=(e,t,o,n)=>{const i=r(e,o),s=r(t,n);return 1===i||1===s||2===i&&(0===s||2===s)||0===i&&2===s},F=(e,t,o,n)=>{const i=r(e,o),s=r(t,n);return i<3&&(s<2||2===s&&0===i)},j=(e,t,n,i)=>{const s=r(e,n),a=r(t,i);return(0,o.knight)(e,t,n,i)||1===s&&3===a||3===s&&1===a},E=(e,t,n,r)=>(0,o.knight)(e,t,n,r)||(0,o.queen)(e,t,n,r),R=(e,t,o,n)=>{const i=r(e,o),s=r(t,n);return i===s&&i<4||0===s&&2===i||2===s&&i<2},U=(e,t,o,n)=>{const i=r(e,o),s=r(t,n);return i<3&&s<3&&!(1===i&&0===s)&&!(0===i&&1===s)};const W=(e,t,o,n)=>d(e,t,o,n)&&n!==t;o.premove=function(e,t,L,B,I,$){const V=e.get(t),X=V.role,z=V.color;if(!V)return[];const H=n.key2pos(t);let G;switch(I){case"xiangqi":case"manchu":switch(X){case"p-piece":G=function(e){return(t,o,n,i)=>n===t&&("white"===e?i===o+1:i===o-1)||i===o&&r(t,n)<2&&("white"===e?o>5:o<6)}(z);break;case"c-piece":case"r-piece":G=a;break;case"n-piece":G=o.knight;break;case"b-piece":G=O(z);break;case"a-piece":G=function(e,t){const o=q(t,e);return(e,t,n,r)=>h(e,t,n,r)&&o.some((e=>e[0]===n&&e[1]===r))}(z,B);break;case"k-piece":G=x(z,B);break;case"m-piece":G=b}break;case"janggi":switch(V.role){case"p-piece":G=function(e,t){const o=q(t,n.opposite(e));return(t,n,i,s)=>{let a;switch(o.findIndex((e=>e[0]===t&&e[1]===n))){case 0:a=(t,o,n,r)=>n===t+1&&"black"===e&&r===o-1;break;case 2:a=(t,o,n,r)=>n===t-1&&"black"===e&&r===o-1;break;case 4:a=(t,o,n,i)=>1===r(t,n)&&("white"===e?i===o+1:i===o-1);break;case 6:a=(t,o,n,r)=>n===t+1&&"white"===e&&r===o+1;break;case 8:a=(t,o,n,r)=>n===t-1&&"white"===e&&r===o+1;break;default:a=()=>!1}return i===t&&("white"===e?s===n+1:s===n-1)||s===n&&r(t,i)<2||a(t,n,i,s)}}(z,B);break;case"c-piece":case"r-piece":G=function(e){const t=q(e,"white"),o=q(e,"black");return(e,n,i,s)=>{let c;const l=t.findIndex((t=>t[0]===e&&t[1]===n)),d=o.findIndex((t=>t[0]===e&&t[1]===n)),p=-1!==l?l:d,u=r(e,i),f=r(n,s);switch(p){case 0:c=(e,t,o,n)=>u===f&&o>e&&o<=e+2&&n<t&&n>=t-2;break;case 2:c=(e,t,o,n)=>u===f&&o<e&&o>=e-2&&n<t&&n>=t-2;break;case 4:c=h;break;case 6:c=(e,t,o,n)=>u===f&&o>e&&o<=e+2&&n>t&&n<=t+2;break;case 8:c=(e,t,o,n)=>u===f&&o<e&&o>=e-2&&n>t&&n<=t+2;break;default:c=()=>!1}return a(e,n,i,s)||c(e,n,i,s)}}(B);break;case"n-piece":G=o.knight;break;case"b-piece":G=T;break;case"a-piece":case"k-piece":G=function(e,t){const o=q(t,e);return(e,t,n,r)=>{let i;switch(o.findIndex((o=>o[0]===e&&o[1]===t))){case 0:i=(e,t,o,n)=>o===e+1&&n===t-1;break;case 2:i=(e,t,o,n)=>o===e-1&&n===t-1;break;case 4:i=h;break;case 6:i=(e,t,o,n)=>o===e+1&&n===t+1;break;case 8:i=(e,t,o,n)=>o===e-1&&n===t+1;break;default:i=()=>!1}return(u(e,t,n,r)||i(e,t,n,r))&&o.some((e=>e[0]===n&&e[1]===r))}}(z,B)}break;case"minixiangqi":switch(V.role){case"p-piece":G=D(z);break;case"c-piece":case"r-piece":G=a;break;case"n-piece":G=o.knight;break;case"k-piece":G=x(z,B)}break;case"shogi":case"minishogi":case"gorogoro":switch(V.role){case"p-piece":G=P(z);break;case"l-piece":G=k(z);break;case"n-piece":G=C(z);break;case"k-piece":G=d;break;case"s-piece":G=w(z);break;case"pp-piece":case"pl-piece":case"pn-piece":case"ps-piece":case"g-piece":G=y(z);break;case"b-piece":G=s;break;case"r-piece":G=a;break;case"pr-piece":G=M;break;case"pb-piece":G=S}break;case"kyotoshogi":switch(V.role){case"l-piece":G=k(z);break;case"pl-piece":case"pn-piece":G=y(z);break;case"s-piece":G=w(z);break;case"ps-piece":G=s;break;case"n-piece":G=C(z);break;case"p-piece":G=P(z);break;case"pp-piece":G=a;break;case"k-piece":G=d}break;case"dobutsu":switch(V.role){case"c-piece":G=P(z);break;case"e-piece":G=h;break;case"g-piece":G=u;break;case"l-piece":G=d;break;case"pc-piece":G=y(z)}break;case"torishogi":switch(X){case"s-piece":G=P(z);break;case"ps-piece":G=function(e){return(t,o,n,i)=>{const s=r(t,n);return"white"===e?2===s&&i===o+2||0===s&&i===o-2:2===s&&i===o-2||0===s&&i===o+2}}(z);break;case"l-piece":G=function(e){return(t,o,n,i)=>{const s=r(t,n),a=r(o,i);return"white"===e?n===t&&i>o||s===a&&n>t&&i<o||n===t-1&&i===o-1:n===t&&i<o||s===a&&n<t&&i>o||n===t+1&&i===o+1}}(z);break;case"r-piece":G=function(e){return(t,o,n,i)=>{const s=r(t,n),a=r(o,i);return"white"===e?n===t&&i>o||s===a&&n<t&&i<o||n===t+1&&i===o-1:n===t&&i<o||s===a&&n>t&&i>o||n===t-1&&i===o+1}}(z);break;case"p-piece":G=function(e){return(t,o,n,i)=>{const s=r(t,n);return"white"===e?n===t&&i===o+2||1===s&&i===o-1:n===t&&i===o-2||1===s&&i===o+1}}(z);break;case"c-piece":G=W;break;case"f-piece":G=function(e){return(t,o,n,r)=>"white"===e?d(t,o,n,r)&&!(n===t&&r===o-1):d(t,o,n,r)&&!(n===t&&r===o+1)}(z);break;case"pf-piece":G=function(e){return(t,o,n,i)=>{const s=r(t,n),a=r(o,i);return"white"===e?d(t,o,n,i)||s===a&&(i>o||i<o&&a<=2)||n===t&&i<o:d(t,o,n,i)||s===a&&(i<o||i>o&&a<=2)||n===t&&i>o}}(z);break;case"k-piece":G=d}break;case"makruk":case"makpong":case"sittuyin":case"cambodian":switch(X){case"p-piece":G=i(z);break;case"r-piece":G=a;break;case"n-piece":G=o.knight;break;case"s-piece":G=w(z);break;case"f-piece":case"m-piece":G=h;break;case"k-piece":G=d}break;case"grand":case"grandhouse":switch(X){case"p-piece":G=v(z);break;case"r-piece":G=a;break;case"n-piece":G=o.knight;break;case"b-piece":G=s;break;case"q-piece":G=o.queen;break;case"c-piece":G=b;break;case"a-piece":G=f;break;case"k-piece":G=d}break;case"shako":switch(X){case"p-piece":G=v(z);break;case"c-piece":case"r-piece":G=a;break;case"n-piece":G=o.knight;break;case"b-piece":G=s;break;case"q-piece":G=o.queen;break;case"e-piece":G=A;break;case"k-piece":G=function(e,t,o){return(r,i,s,a)=>d(r,i,s,a)||o&&i===a&&i===("white"===e?2:9)&&6===r&&(8===s&&n.containsX(t,9)||4===s&&n.containsX(t,2))}(z,function(e,t){const o="white"===t?"2":"9",r=[];for(const[i,s]of e)i[1]===o&&s&&s.color===t&&"r-piece"===s.role&&r.push(n.key2pos(i)[0]);return r}(e,z),L)}break;case"shogun":switch(X){case"p-piece":G=i(z);break;case"pp-piece":G=d;break;case"r-piece":G=a;break;case"pr-piece":G=b;break;case"n-piece":G=o.knight;break;case"pn-piece":G=m;break;case"b-piece":G=s;break;case"pb-piece":G=f;break;case"f-piece":G=h;break;case"pf-piece":G=o.queen;break;case"k-piece":G=c(z,l(e,z),L)}break;case"orda":case"ordamirror":switch(X){case"p-piece":G=i(z);break;case"r-piece":G=a;break;case"n-piece":G=o.knight;break;case"b-piece":G=s;break;case"q-piece":G=o.queen;break;case"l-piece":G=b;break;case"h-piece":G=m;break;case"a-piece":G=f;break;case"y-piece":G=w(z);break;case"f-piece":G=g;break;case"k-piece":G=c(z,l(e,z),L)}break;case"synochess":switch(X){case"p-piece":G=i(z);break;case"c-piece":case"r-piece":G=a;break;case"n-piece":G=o.knight;break;case"b-piece":G=s;break;case"q-piece":G=o.queen;break;case"s-piece":G=D(z);break;case"e-piece":G=A;break;case"a-piece":G=d;break;case"k-piece":G=c(z,l(e,z),L&&"white"===z)}break;case"musketeer":switch(X){case"p-piece":G=i(z);break;case"r-piece":G=a;break;case"n-piece":G=o.knight;break;case"b-piece":G=s;break;case"q-piece":G=o.queen;break;case"l-piece":G=K;break;case"o-piece":G=F;break;case"u-piece":G=j;break;case"d-piece":G=E;break;case"c-piece":G=b;break;case"a-piece":G=f;break;case"e-piece":G=N;break;case"h-piece":G=_;break;case"f-piece":G=R;break;case"s-piece":G=U;break;case"k-piece":G=c(z,l(e,z),L)}break;case"hoppelpoppel":switch(X){case"p-piece":G=i(z);break;case"r-piece":G=a;break;case"n-piece":case"b-piece":G=f;break;case"q-piece":G=o.queen;break;case"k-piece":G=c(z,l(e,z),L)}break;case"shinobi":switch(X){case"p-piece":G=i(z);break;case"pl-piece":case"r-piece":G=a;break;case"ph-piece":case"n-piece":G=o.knight;break;case"pm-piece":case"b-piece":G=s;break;case"q-piece":G=o.queen;break;case"pp-piece":case"c-piece":G=d;break;case"l-piece":G=k(z);break;case"h-piece":G=C(z);break;case"m-piece":G=h;break;case"d-piece":G=M;break;case"j-piece":G=f;break;case"k-piece":G=c(z,l(e,z),L)}break;case"empire":switch(X){case"p-piece":G=i(z);break;case"s-piece":G=D(z);break;case"r-piece":G=a;break;case"n-piece":G=o.knight;break;case"b-piece":G=s;break;case"d-piece":case"t-piece":case"c-piece":case"q-piece":G=o.queen;break;case"e-piece":G=g;break;case"k-piece":G=c(z,l(e,z),L)}break;case"capablanca":case"capahouse":switch(X){case"p-piece":G=i(z);break;case"r-piece":G=a;break;case"n-piece":G=o.knight;break;case"b-piece":G=s;break;case"q-piece":G=o.queen;break;case"c-piece":G=b;break;case"a-piece":G=f;break;case"k-piece":G=$?p(z,l(e,z),L):function(e,t,o){return(r,i,s,a)=>d(r,i,s,a)||o&&i===a&&i===("white"===e?1:8)&&6===r&&(9===s&&n.containsX(t,10)||3===s&&n.containsX(t,1))}(z,l(e,z),L)}break;default:switch(X){case"p-piece":G=i(z);break;case"r-piece":G=a;break;case"n-piece":G=o.knight;break;case"b-piece":G=s;break;case"q-piece":G=o.queen;break;case"e-piece":case"c-piece":G=b;break;case"h-piece":case"a-piece":G=f;break;case"k-piece":G=$?p(z,l(e,z),L):c(z,l(e,z),L);break;case"l-piece":G=o.loachecker}}return n.allKeys(B).map(n.key2pos).filter((e=>(H[0]!==e[0]||H[1]!==e[1])&&G(H[0],H[1],e[0],e[1]))).map(n.pos2key)}},{"./util":20}],15:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.updateBounds=o.render=void 0;const n=e("./util"),r=e("./board"),i=e("./transformations");function s(e){return"PIECE"===e.tagName}function a(e){return"SQUARE"===e.tagName}function c(e,t){for(const o of t)e.dom.elements.board.removeChild(o)}function l(e,t,o,n){let r=2+((e=i.mapToWhite[t](e,n))[1]-1)*n.height+(n.width-e[0]);return o&&(r=67-r),r+""}function d(e,t){const o=e.promoted?"promoted ":"",n=e.color===t?"ally":"enemy";return`${e.color} ${o}${e.role} ${n}`}function p(e,t,o){const n=e.get(t);n?e.set(t,`${n} ${o}`):e.set(t,o)}function u(e,t,o){const n=e.get(t);n?n.push(o):e.set(t,[o])}o.render=function(e){const t=e.orientation,o=(0,r.whitePov)(e),i=e.dom.relative?n.posToTranslateRel:(0,n.posToTranslateAbs)(e.dom.bounds(),e.dimensions),h=e.dom.relative?n.translateRel:n.translateAbs,f=e.dom.elements.board,b=e.pieces,g=e.animation.current,m=g?g.plan.anims:new Map,v=g?g.plan.fadings:new Map,k=e.draggable.current,w=function(e){var t,o,n,r;const i=new Map;if(e.lastMove&&e.highlight.lastMove)for(const c of e.lastMove)"a0"!==c&&p(i,c,"last-move");e.check&&e.highlight.check&&p(i,e.check,"check");if(e.selected){if(p(i,e.selected,"selected"),e.movable.showDests){const o=null===(t=e.movable.dests)||void 0===t?void 0:t.get(e.selected);if(o)for(const t of o)p(i,t,"move-dest"+(e.pieces.has(t)?" oc":""));const n=e.premovable.dests;if(n)for(const t of n)p(i,t,"premove-dest"+(e.pieces.has(t)?" oc":""))}}else if(e.dropmode.active||"a0"===(null===(o=e.draggable.current)||void 0===o?void 0:o.orig)){const t=e.dropmode.active?e.dropmode.piece:null===(n=e.draggable.current)||void 0===n?void 0:n.piece;if(t){if(e.dropmode.showDropDests){const o=null===(r=e.dropmode.dropDests)||void 0===r?void 0:r.get(t.role);if(o)for(const e of o)p(i,e,"move-dest")}if(e.predroppable.showDropDests){const t=e.predroppable.dropDests;if(t)for(const o of t)p(i,o,"premove-dest"+(e.pieces.has(o)?" oc":""))}}}const s=e.premovable.current;if(s)for(const c of s)p(i,c,"current-premove");else e.predroppable.current&&p(i,e.predroppable.current.key,"current-premove");const a=e.exploding;if(a)for(const c of a.keys)p(i,c,"exploding"+a.stage);return i}(e),y=new Set,P=new Set,C=new Map,M=new Map;let S,q,D,O,x,A,T,K,_,N;for(q=f.firstChild;q;){if(S=q.cgKey,s(q))if(D=b.get(S),x=m.get(S),A=v.get(S),O=q.cgPiece,!q.cgDragging||k&&k.orig===S||(q.classList.remove("dragging"),h(q,i((0,n.key2pos)(S),t,e.dimensions)),q.cgDragging=!1),!A&&q.cgFading&&(q.cgFading=!1,q.classList.remove("fading")),D){if(x&&q.cgAnimating&&O===d(D,e.myColor)){const o=(0,n.key2pos)(S);o[0]+=x[2],o[1]+=x[3],q.classList.add("anim"),h(q,i(o,t,e.dimensions))}else q.cgAnimating&&(q.cgAnimating=!1,q.classList.remove("anim"),h(q,i((0,n.key2pos)(S),t,e.dimensions)),e.addPieceZIndex&&(q.style.zIndex=l((0,n.key2pos)(S),t,o,e.dimensions)));O!==d(D,e.myColor)||A&&q.cgFading?A&&O===d(A,e.myColor)?(q.classList.add("fading"),q.cgFading=!0):u(C,O,q):y.add(S)}else u(C,O,q);else if(a(q)){const e=q.className;w.get(S)===e?P.add(S):M.has(e)?u(M,e,q):M.set(e,[q])}q=q.nextSibling}for(const[r,s]of w)if(!P.has(r)){_=M.get(s),N=_&&_.pop();const o=i((0,n.key2pos)(r),t,e.dimensions);if(N)N.cgKey=r,h(N,o);else{const e=(0,n.createEl)("square",s);e.cgKey=r,h(e,o),f.insertBefore(e,f.firstChild)}}for(const[r,s]of b)if(x=m.get(r),!y.has(r))if(T=C.get(d(s,e.myColor)),K=T&&T.pop(),K){K.cgKey=r,K.cgFading&&(K.classList.remove("fading"),K.cgFading=!1);const s=(0,n.key2pos)(r);e.addPieceZIndex&&(K.style.zIndex=l(s,t,o,e.dimensions)),x&&(K.cgAnimating=!0,K.classList.add("anim"),s[0]+=x[2],s[1]+=x[3]),h(K,i(s,t,e.dimensions))}else{const a=d(s,e.myColor),c=(0,n.createEl)("piece",a),p=(0,n.key2pos)(r);c.cgPiece=a,c.cgKey=r,x&&(c.cgAnimating=!0,p[0]+=x[2],p[1]+=x[3]),h(c,i(p,t,e.dimensions)),e.addPieceZIndex&&(c.style.zIndex=l(p,t,o,e.dimensions)),f.appendChild(c)}for(const n of C.values())c(e,n);for(const n of M.values())c(e,n)},o.updateBounds=function(e){if(e.dom.relative)return;const t=e.orientation,o=(0,n.posToTranslateAbs)(e.dom.bounds(),e.dimensions);let r=e.dom.elements.board.firstChild;for(;r;)(s(r)&&!r.cgAnimating||a(r))&&(0,n.translateAbs)(r,o((0,n.key2pos)(r.cgKey),t)),r=r.nextSibling}},{"./board":3,"./transformations":18,"./util":20}],16:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.defaults=void 0;const n=e("./fen"),r=e("./util");o.defaults=function(){return{pieces:n.read(n.initial,{width:8,height:8}),orientation:"white",myColor:"white",startColor:"white",turnColor:"white",coordinates:!0,autoCastle:!0,viewOnly:!1,disableContextMenu:!1,resizable:!0,addPieceZIndex:!1,pieceKey:!1,highlight:{lastMove:!0,check:!0},animation:{enabled:!0,duration:200},movable:{free:!0,color:"both",showDests:!0,events:{},rookCastle:!0},premovable:{enabled:!0,showDests:!0,castle:!0,events:{}},predroppable:{enabled:!1,showDropDests:!0,events:{}},draggable:{enabled:!0,distance:3,autoDistance:!0,centerPiece:!0,showGhost:!0,deleteOnDropOff:!1},dropmode:{active:!1,showDropDests:!0},selectable:{enabled:!0},stats:{dragged:!("ontouchstart"in window)},events:{},drawable:{enabled:!0,visible:!0,defaultSnapToValidMove:!0,eraseOnClick:!0,shapes:[],autoShapes:[],brushes:{green:{key:"g",color:"#15781B",opacity:1,lineWidth:10},red:{key:"r",color:"#882020",opacity:1,lineWidth:10},blue:{key:"b",color:"#003088",opacity:1,lineWidth:10},yellow:{key:"y",color:"#e68f00",opacity:1,lineWidth:10},paleBlue:{key:"pb",color:"#003088",opacity:.4,lineWidth:15},paleGreen:{key:"pg",color:"#15781B",opacity:.4,lineWidth:15},paleRed:{key:"pr",color:"#882020",opacity:.4,lineWidth:15},paleGrey:{key:"pgr",color:"#4a4a4a",opacity:.35,lineWidth:15}},pieces:{baseUrl:"https://playstrategy.org/assets/piece/cburnett/"},prevSvgHash:""},hold:(0,r.timer)(),dimensions:{width:8,height:8},variant:"chess",chess960:!1,notation:0}}},{"./fen":11,"./util":20}],17:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.setAttributes=o.renderSvg=o.createElement=void 0;const n=e("./util"),r=e("./transformations");function i(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function s(e,t,o,n,r){const i=e.dom.bounds(),s=new Map,a=[];for(const d of t)s.set(d.hash,!1);let c,l=r.firstChild;for(;l;)c=l.getAttribute("cgHash"),s.has(c)?s.set(c,!0):a.push(l),l=l.nextSibling;for(const d of a)r.removeChild(d);for(const p of t)s.get(p.hash)||r.appendChild(d(e,p,o,n,i))}function a({orig:e,dest:t,brush:o,piece:n,modifiers:r,customSvg:i},s,a,d){return[d.width,d.height,a,e,t,o,t&&(s.get(t)||0)>1,n&&c(n),r&&(p=r,""+(p.lineWidth||"")),i&&l(i)].filter((e=>e)).join(",");var p}function c(e){return[e.color,e.role,e.scale].filter((e=>e)).join(",")}function l(e){let t=0;for(let o=0;o<e.length;o++)t=(t<<5)-t+e.charCodeAt(o)>>>0;return"custom-"+t.toString()}function d(e,{shape:t,current:o,hash:r},s,a,c){let l;if(t.customSvg){const o=h((0,n.key2pos)(t.orig),e.orientation,e.dimensions);l=function(e,t,o,n){const{width:r,height:s}=o,a=r/n.width,c=s/n.height,l=(t[0]-1)*a,d=(n.height-t[1])*c,p=u(i("g"),{transform:`translate(${l},${d})`}),h=u(i("svg"),{width:a,height:c,viewBox:"0 0 100 100"});return p.appendChild(h),h.innerHTML=e,p}(t.customSvg,o,c,e.dimensions)}else if(t.piece)l=function(e,t,o,n,r,s,a){const c=m(t,n,r),l=n.width/r.width*(o.scale||1),d=n.height/r.height*(o.scale||1),p=function(e,t){switch(e){case"shogi":switch(t.role){case"pp-piece":return"0TO";case"pl-piece":return"0NY";case"pn-piece":return"0NK";case"ps-piece":return"0NG";case"pr-piece":return"0RY";case"pb-piece":return"0UM";default:return""}case"xiangqi":return("white"===t.color?"R":"B")+t.role[0].toUpperCase();default:return t.color[0]+t.role[0].toUpperCase()}}(a,o),h=e.endsWith("/")?e.slice("https://playstrategy.org".length)+p+".svg":e,f=o.color===s?"ally":"enemy";return u(i("image"),{className:`${o.role} ${o.color} ${f}`,x:c[0]-l/2,y:c[1]-d/2,width:l,height:d,href:h})}(e.drawable.pieces.baseUrl,h((0,n.key2pos)(t.orig),e.orientation,e.dimensions),t.piece,c,e.dimensions,e.myColor,e.variant);else{const r=h((0,n.key2pos)(t.orig),e.orientation,e.dimensions);if(t.orig&&t.dest){let d=s[t.brush];t.modifiers&&(d=f(d,t.modifiers)),l=function(e,t,o,n,r,s,a){const c=function(e,t,o){return(t?20:10)/(64*o.width)*e.width}(s,r&&!n,a),l=m(t,s,a),d=m(o,s,a),p=d[0]-l[0],h=d[1]-l[1],f=Math.atan2(h,p),v=Math.cos(f)*c,k=Math.sin(f)*c;return u(i("line"),{stroke:e.color,"stroke-width":b(e,n,s,a),"stroke-linecap":"round","marker-end":"url(#arrowhead-"+e.key+")",opacity:g(e,n),x1:l[0],y1:l[1],x2:d[0]-v,y2:d[1]-k})}(d,r,h((0,n.key2pos)(t.dest),e.orientation,e.dimensions),o,(a.get(t.dest)||0)>1,c,e.dimensions)}else l=function(e,t,o,n,r){const s=m(t,n,r),a=function(e,t){const o=e.width/(64*t.width);return[3*o,4*o]}(n,r),c=(n.width+n.height)/(2*(r.height+r.width));return u(i("circle"),{stroke:e.color,"stroke-width":a[o?0:1],fill:"none",opacity:g(e,o),cx:s[0],cy:s[1],r:c-a[1]/2})}(s[t.brush],r,o,c,e.dimensions)}return l.setAttribute("cgHash",r),l}function p(e){const t=u(i("marker"),{id:"arrowhead-"+e.key,orient:"auto",markerWidth:4,markerHeight:8,refX:2.05,refY:2.01});return t.appendChild(u(i("path"),{d:"M0,0 V4 L3,2 Z",fill:e.color})),t.setAttribute("cgKey",e.key),t}function u(e,t){for(const o in t)e.setAttribute(o,t[o]);return e}function h(e,t,o){return r.mapToWhiteInverse[t](e,o)}function f(e,t){return{color:e.color,opacity:Math.round(10*e.opacity)/10,lineWidth:Math.round(t.lineWidth||e.lineWidth),key:[e.key,t.lineWidth].filter((e=>e)).join("")}}function b(e,t,o,n){return(e.lineWidth||10)*(t?.85:1)/(64*n.width)*o.width}function g(e,t){return(e.opacity||1)*(t?.9:1)}function m(e,t,o){return[(e[0]-.5)*t.width/o.width,(o.height+.5-e[1])*t.height/o.height]}o.createElement=i,o.renderSvg=function(e,t,o){const n=e.drawable,r=n.current,i=r&&r.mouseSq?r:void 0,c=new Map,l=e.dom.bounds();for(const s of n.shapes.concat(n.autoShapes).concat(i?[i]:[]))s.dest&&c.set(s.dest,(c.get(s.dest)||0)+1);const d=n.shapes.concat(n.autoShapes).map((e=>({shape:e,current:!1,hash:a(e,c,!1,l)})));i&&d.push({shape:i,current:!0,hash:a(i,c,!0,l)});const u=d.map((e=>e.hash)).join(";");if(u===e.drawable.prevSvgHash)return;e.drawable.prevSvgHash=u;const h=t.querySelector("defs"),b=t.querySelector("g"),g=o.querySelector("g");!function(e,t,o){const n=new Map;let r;for(const a of t)a.shape.dest&&(r=e.brushes[a.shape.brush],a.shape.modifiers&&(r=f(r,a.shape.modifiers)),n.set(r.key,r));const i=new Set;let s=o.firstChild;for(;s;)i.add(s.getAttribute("cgKey")),s=s.nextSibling;for(const[a,c]of n.entries())i.has(a)||o.appendChild(p(c))}(n,d,h),s(e,d.filter((e=>!e.shape.customSvg)),n.brushes,c,b),s(e,d.filter((e=>e.shape.customSvg)),n.brushes,c,g)},o.setAttributes=u},{"./transformations":18,"./util":20}],18:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.translateBase=o.mapToWhiteInverse=o.mapToWhite=void 0,o.mapToWhite={white:(e,t)=>e,black:(e,t)=>[t.width+1-e[0],t.height+1-e[1]],right:(e,t)=>[t.height+1-e[1],e[0]],left:(e,t)=>[e[1],t.width+1-e[0]]},o.mapToWhiteInverse={white:(e,t)=>e,black:(e,t)=>[t.width+1-e[0],t.height+1-e[1]],right:(e,t)=>[e[1],t.width+1-e[0]],left:(e,t)=>[t.width+1-e[0],e[1]]},o.translateBase={white:(e,t,o,n)=>[(e[0]-1)*t,(n.height-e[1])*o],black:(e,t,o,n)=>[(n.width-e[0])*t,(e[1]-1)*o],right:(e,t,o,n)=>[(e[1]-1)*t,(e[0]-1)*o],left:(e,t,o,n)=>[(n.width-e[0])*t,(e[1]-1)*o]}},{}],19:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.xiangqiVariants=o.shogiVariants=o.letters=o.ranks10=o.ranks=o.files=o.colors=o.orientations=void 0,o.orientations=["white","black","left","right"],o.colors=["white","black"],o.files=["a","b","c","d","e","f","g","h","i","j"],o.ranks=["1","2","3","4","5","6","7","8","9",":"],o.ranks10=["1","2","3","4","5","6","7","8","9","10"],o.letters=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],o.shogiVariants=["shogi","minishogi","kyotoshogi","dobutsu","gorogoro","torishogi"],o.xiangqiVariants=["xiangqi","minixiangqi","manchu","janggi"]},{}],20:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.callUserFunction=o.computeSquareCenter=o.createEl=o.isRightButton=o.eventPosition=o.setVisible=o.translateRel=o.translateAbs=o.posToTranslateRel=o.posToTranslateAbs=o.samePiece=o.distanceSq=o.containsX=o.isColor=o.orientationForLOA=o.oppositeOrientationForLOA=o.oppositeOrientation=o.opposite=o.timer=o.memo=o.allPos=o.key2pos=o.pos2key=o.allKeys=o.invNRanks=o.NRanks=o.invRanks=o.colors=void 0;const n=e("./types"),r=e("./transformations");function i(e={width:8,height:8}){return Array.prototype.concat(...(t=e.width,n.files.slice(0,t)).map((t=>function(e){return n.ranks10.slice(0,e)}(e.height).map((e=>t+e)))));var t}function s(e){return[e.charCodeAt(0)-96,parseInt(e.slice(1))]}o.colors=["white","black"],o.invRanks=[...n.ranks10].reverse(),o.NRanks=[1,2,3,4,5,6,7,8,9,10],o.invNRanks=[10,9,8,7,6,5,4,3,2,1],o.allKeys=i,o.pos2key=function(e){return n.files[e[0]-1]+n.ranks10[e[1]-1]},o.key2pos=s;o.allPos=e=>i(e).map(s),o.memo=function(e){let t;const o=()=>(void 0===t&&(t=e()),t);return o.clear=()=>{t=void 0},o};o.timer=()=>{let e;return{start(){e=performance.now()},cancel(){e=void 0},stop(){if(!e)return 0;const t=performance.now()-e;return e=void 0,t}}};o.opposite=e=>"white"===e?"black":"white";const a={white:"black",black:"white",left:"right",right:"left"};o.oppositeOrientation=e=>a[e];const c={white:"right",black:"white"};o.oppositeOrientationForLOA=e=>c[e];const l={white:"white",black:"right"};o.orientationForLOA=e=>l[e];o.isColor=e=>"white"===e||"black"===e,o.containsX=function(e,t){return void 0!==e&&-1!==e.indexOf(t)};o.distanceSq=(e,t)=>{const o=e[0]-t[0],n=e[1]-t[1];return o*o+n*n};o.samePiece=(e,t)=>e.role===t.role&&e.color===t.color;const d=(e,t,o,n,i)=>r.translateBase[t](e,o,n,i);o.posToTranslateAbs=(e,t)=>{const o=e.width/t.width,n=e.height/t.height;return(e,r)=>d(e,r,o,n,t)};o.posToTranslateRel=(e,t,o)=>d(e,t,100,100,o);o.translateAbs=(e,t)=>{e.style.transform=`translate(${t[0]}px,${t[1]}px)`};o.translateRel=(e,t)=>{e.style.transform=`translate(${t[0]}%,${t[1]}%)`};o.setVisible=(e,t)=>{e.style.visibility=t?"visible":"hidden"};o.eventPosition=e=>{var t;return e.clientX||0===e.clientX?[e.clientX,e.clientY]:(null===(t=e.targetTouches)||void 0===t?void 0:t[0])?[e.targetTouches[0].clientX,e.targetTouches[0].clientY]:void 0};o.isRightButton=e=>2===e.buttons||2===e.button;o.createEl=(e,t)=>{const o=document.createElement(e);return t&&(o.className=t),o},o.computeSquareCenter=function(e,t,o,n){const i=r.mapToWhiteInverse[t](s(e),n);return[o.left+o.width*(i[0]-1+.5)/n.width,o.top+o.height*(n.height-(i[1]-1+.5))/n.height]},o.callUserFunction=function(e,...t){e&&setTimeout((()=>e(...t)),1)}},{"./transformations":18,"./types":19}],21:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.renderWrap=void 0;const n=e("./util"),r=e("./types"),i=e("./svg");function s(e,t){const o=(0,n.createEl)("coords",t);let r;for(const i of e)r=(0,n.createEl)("coord"),r.textContent=i,o.appendChild(r);return o}o.renderWrap=function(e,t,o){e.innerHTML="",e.classList.add("cg-wrap");for(const n of r.orientations)e.classList.toggle("orientation-"+n,t.orientation===n);e.classList.toggle("manipulable",!t.viewOnly);const a=(0,n.createEl)("cg-helper");e.appendChild(a);const c=(0,n.createEl)("cg-container");a.appendChild(c);const l=(0,n.createEl)("extension");c.appendChild(l);const d=(0,n.createEl)("cg-board");let p,u,h;if(c.appendChild(d),t.drawable.visible&&!o&&(p=(0,i.setAttributes)((0,i.createElement)("svg"),{class:"cg-shapes"}),p.appendChild((0,i.createElement)("defs")),p.appendChild((0,i.createElement)("g")),u=(0,i.setAttributes)((0,i.createElement)("svg"),{class:"cg-custom-svgs"}),u.appendChild((0,i.createElement)("g")),c.appendChild(p),c.appendChild(u)),t.coordinates){const e=" "+t.orientation,o=r.shogiVariants.includes(t.variant),n=r.xiangqiVariants.includes(t.variant);o?(c.appendChild(s(r.ranks.slice(0,t.dimensions.height).reverse(),"files"+e)),c.appendChild(s(r.ranks.slice(0,t.dimensions.width).reverse(),"ranks"+e))):6===t.notation?(c.appendChild(s(["0"].concat(r.ranks.slice(0,9).reverse()),"ranks"+e)),c.appendChild(s(r.ranks.slice(0,9),"files"+e))):n?"white"===t.orientation?(c.appendChild(s(r.ranks10.slice(0,t.dimensions.width).reverse(),"files white")),c.appendChild(s(r.ranks10.slice(0,t.dimensions.width).reverse(),"files black"))):(c.appendChild(s(r.ranks10.slice(0,t.dimensions.width),"files white")),c.appendChild(s(r.ranks10.slice(0,t.dimensions.width),"files black"))):(c.appendChild(s(r.ranks10.slice(0,t.dimensions.height),"ranks"+e)),c.appendChild(s(r.files.slice(0,t.dimensions.width),"files"+e)))}return t.draggable.showGhost&&!o&&(h=(0,n.createEl)("piece","ghost"),(0,n.setVisible)(h,!1),c.appendChild(h)),{board:d,container:c,ghost:h,svg:p,customSvg:u}}},{"./svg":17,"./types":19,"./util":20}]},{},[12])(12)}));